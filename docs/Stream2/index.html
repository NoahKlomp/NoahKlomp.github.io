<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./hljs/styles/atom-one-dark.min.css">
    <style>
        #0:hover {
            background-color: rgba(255, 0, 0, 0.2);
        }
        .prevent-select, svg {
            -webkit-user-select: none; /* Safari */
            -ms-user-select: none; /* IE 10 and IE 11 */
            user-select: none; /* Standard syntax */
        }
        .clickable {
            cursor: pointer;
        }
        #flowchartcontainer {
            overflow: auto;
            max-height: 100%;
            padding-bottom: 50px;
        }
        #actingButtons {
            height:50px;
            /* width:100%; */
            background-color: gray;
            position: fixed;
            bottom: 0;
            left: 0;
            right:0;
            display: flex;
            
        }
        
        button {
            margin: 10px;
            background-color: honeydew;
            color: black;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .hljs-comment {
            color: #A3D9FF;
        }
        svg {

        }

        svg.statement, svg.DoWhileLoopBox, svg.loopbox, svg.IfBox {
            font-family: monospace;
        }
    </style>
    <script src="./hljs/highlight.min.js"></script>
    
    <script src="./hljs/languages/python.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
    <!-- <script src="js/FlowChartBuilder/base.js" type="module"></script>
    <script src="js/FlowChartBuilder/base.js" type="module"></script> -->
</head>
<body>
    <!-- <svg id="flowchart" width="500" height="500" xmlns="http://www.w3.org/2000/svg">
    </svg> -->
<!--    <script src="./js/Two/main.js"></script>-->
<!--    <script src="./js/Two/design.js"></script>-->
    <!--
        TODO:
          - Make a pop up showing the tutorial
          - Export button
          - To Python / Java Code button
          - Maybe Dutch version
    -->
    <div id="flowchartcontainer"></div>
    <script src="./js/Three/PopUp.js"></script>
    <script src="./js/Three/Creator.js"></script>
    <script src="./js/Three/CodeMaker.js"></script>
    <script src="./js/Three/User.js"></script>
    <script src="./js/Three/Code.js"></script>
    <script src="./js/Three/Editor.js"></script>
    <div id="actingButtons" class="funButtons">
        <button onclick="new CopyCodePopUp('python',main.export);hljs.highlightAll();">To Python Comments</button>
        <button onclick="new CopyCodePopUp('java',main.export);hljs.highlightAll();">To Java Comments</button>
        <button onclick="navigator.clipboard.writeText(window.location.href);">Copy URL</button>
        <button onclick="window.location.href = window.location.origin+window.location.pathname;">Reset</button>
        <button id="toImgButton">Export to image</button>
        <script type="module">
            // Import Canvg from the Skypack CDN
            import { Canvg } from 'https://cdn.skypack.dev/canvg';

            // Set an initialization variable to null
            let v = null;
            let but = document.querySelector("#toImgButton");
            

            // Create a function that fires when the
            // web browser loads the file
            but.onclick = () => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                // Read the SVG string using the fromString method
                // of Canvg
                v = Canvg.fromString(ctx, document.querySelector("#flowchartcontainer").innerHTML);

                // Start drawing the SVG on the canvas
                v.start();

                // Convert the Canvas to an image
                var img = canvas.toDataURL("img/png");
                downloadFile(img, "Flowchart.png");
            }

            function downloadFile(url, fileName = "unnamed")  {
                // File content and filename
                // const fileName = "example.txt";

                // Create a Blob object with the file content

                // Create a temporary link element
                const link = document.createElement('a');
                link.href = url;
                link.download = fileName;

                // Programmatically click the link to trigger the download
                link.click();

                // Clean up the URL object
                URL.revokeObjectURL(link.href);
            }
        </script>
    </div>
</body>
</html>